{% extends base_template %} {% load i18n %}
{% block css %}
    {{ block.super }}
    <link rel='stylesheet' href='/styles/{{ user.skin.name|getskincss:"forms.css" }}' media='screen' type='text/css'>
{% endblock %}
{% block text_content %}
<center>
    <div class='forms'>
        <form id='id_add_roster_form' action='.' method='post'>
            {% csrf_token %}
            {{ form.as_ul }}
            <input type='submit' value='{% trans "submit" %}'>
        </form>
    </div>
</center>
<script language='javascript'>
var _xhr_get_codex_revisions = '{% url xhr_get_codex_revisions %}';

var revision = document.getElementById('id_revision');
var codex = document.getElementById('id_codex');
var updateRevision = function(){
    url = _xhr_get_codex_revisions + codex.options[codex.selectedIndex].value;
    $.getJSON(url, function(data){
        revlist = data.revlist;
        revision.value = revlist[revlist.length-1];
        p = $('<span class="info">Available revisions: '+ data.revisions +'</span>');
        _parent = $("#"+revision.id).parent();
        if (_parent.children("span.info").length){
            _parent.children("span.info").text("Available revisions: " + data.revisions);
        }else{
            $(p).insertBefore("#"+revision.id);
        }
    });
}
$(document).ready(function(){
    $('#id_codex').change(function(){
        updateRevision();
    });
});
</script>
{% endblock %}
