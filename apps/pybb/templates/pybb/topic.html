{% extends 'pybb/base.html' %}
{% load pybb_extras %}
{% load i18n %}

{% block content %}
<ul class='breadcrumb'>
    <li><a href="{% url "pybb_index" %}">{% trans "Root" %}</a></li>
    <li>{% pybb_link topic.forum.category %}</li>
    <li>{% pybb_link topic.forum %}</li>
    <li><strong>{% pybb_link topic %}</strong></li>
</ul>

{% pybb_pagination %}

<div class="posts">
    {% if first_post %}{% ifnotequal first_post posts.0 %}
        {% with first_post as post %}
            {% include "pybb/post_template.html" %}
        {% endwith %}
    {% endifnotequal %}{% endif %}
    {% for post in posts %}
        {% include "pybb/post_template.html" %}
    {% endfor %}
</div>

{% pybb_pagination %}

<div class="breadcrumb">
    {% if moderator %}
    {% if topic.sticky %}
    <li>
        <a href="{% url "pybb_unstick_topic" topic.id %}">{% trans "Unstick topic" %}</a>
    </li>
    {% else %}
    <li>
        <a href="{% url "pybb_stick_topic" topic.id %}">{% trans "Stick topic" %}</a>
    </li>
    {% endif %}
    {% if topic.closed %}
    <li>
        <a href="{% url "pybb_open_topic" topic.id %}">{% trans "Open topic" %}</a>
    </li>
    {% else %}
    <li>
        <a href="{% url "pybb_close_topic" topic.id %}">{% trans "Close topic" %}</a>
    </li>
    {% endif %}
    {% endif %}
    {% if user.is_authenticated %}
    {% if subscribed %}
    <li><a href="{% url "pybb_delete_subscription" topic.id %}?from_topic">{% trans "Unsubscribe" %}</a></li>
    {% else %}
    <li><a href="{% url "pybb_add_subscription" topic.id %}">{% trans "Subscribe" %}</a></li>
    {% endif %}
    {% endif %}
</div>

{% if not topic.closed and user.is_authenticated %}
<form action="{% url "pybb_add_post" topic.id %}" method="post" class='form-horizontal'>
    {% csrf_token %}
    <fieldset class='col-lg-7'>
        <legend>{% trans "New reply" %}</legend>
        {% include "forms/bootstrap_horizontal.html" with form=form %}
        <div class='control-group'>
            <div class='controls'>
                <input class='btn btn-{{ user.get_forum_theme|default:gs.FORUM_THEME_DEFAULT }}'
                       type="submit" value="{% trans "Submit" %}" />
            </div>
        </div>
    </fieldset>
</form>
{% endif %}
{% include "pybb/markup.html" %}

{% endblock %}
